{"version":3,"sources":["../../../../../../../assets/Script/src/game/game/assets/Script/src/game/game/GameResult.js"],"names":["Object","defineProperty","exports","value","Tools_1","require","GameManager_1","RecordGrid_1","GameDataManager_1","GameResultClass","randomAry","gameTable","chooseView","get","_instance","enumerable","configurable","prototype","setView","startResult","idiomAry","cc","log","chooseAry","RecordGrid","getChooseGridAry","isSussess","i","length","idiom","isEqual","j","substring","getGridString","playChooseFadeOut","cb1","callFunc","onSuccessFul","node","runAction","sequence","delayTime","GameDataManager","gameData","gridEffectTime","onFailed","clearData","playChooseFadeIn","Tools","getMapLength","getGameTableGridMap","tableWidth","tableHeight","GameManager","onGameLevelup","restoreIdiom","clearRecordData","clearChooseGrid","GameResult","instance"],"mappings":"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","file":"GameResult.js","sourceRoot":"../../../../../../../assets/Script/src/game/game","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Tools_1 = require(\"../../utils/Tools\");\nvar GameManager_1 = require(\"./GameManager\");\nvar RecordGrid_1 = require(\"../common/model/RecordGrid\");\nvar GameDataManager_1 = require(\"../common/data/GameDataManager\");\nvar GameResultClass = (function () {\n    function GameResultClass() {\n        this.randomAry = null;\n        this.gameTable = null;\n        this.chooseView = null;\n    }\n    Object.defineProperty(GameResultClass, \"instance\", {\n        get: function () {\n            if (this._instance == null) {\n                this._instance = new GameResultClass();\n            }\n            return this._instance;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    GameResultClass.prototype.setView = function (gameTable, chooseView) {\n        this.gameTable = gameTable;\n        this.chooseView = chooseView;\n    };\n    GameResultClass.prototype.startResult = function (idiomAry) {\n        cc.log(\"开始判定\");\n        var chooseAry = RecordGrid_1.RecordGrid.getChooseGridAry();\n        var isSussess = false;\n        for (var i = 0; i < idiomAry.length; i++) {\n            var idiom = idiomAry[i];\n            var isEqual = true;\n            for (var j = 0; j < 4; j++) {\n                if (idiom.substring(j, j + 1) != chooseAry[j].getGridString()) {\n                    isEqual = false;\n                    break;\n                }\n            }\n            if (isEqual) {\n                isSussess = true;\n                break;\n            }\n        }\n        if (isSussess) {\n            this.chooseView.playChooseFadeOut();\n            var cb1 = cc.callFunc(this.onSuccessFul, this);\n            this.gameTable.node.runAction(cc.sequence(cc.delayTime(GameDataManager_1.GameDataManager.gameData.gridEffectTime), cb1));\n        }\n        else {\n            this.onFailed();\n        }\n    };\n    GameResultClass.prototype.onSuccessFul = function () {\n        cc.log(\"判定成功\");\n        this.clearData();\n        this.chooseView.playChooseFadeIn();\n        if (Tools_1.Tools.getMapLength(RecordGrid_1.RecordGrid.getGameTableGridMap()) == this.gameTable.tableWidth * this.gameTable.tableHeight) {\n            GameManager_1.GameManager.onGameLevelup();\n        }\n        ;\n    };\n    GameResultClass.prototype.onFailed = function () {\n        cc.log(\"判定失败\");\n        this.chooseView.restoreIdiom();\n        this.clearData();\n    };\n    GameResultClass.prototype.clearData = function () {\n        RecordGrid_1.RecordGrid.clearRecordData();\n        this.chooseView.clearChooseGrid();\n    };\n    return GameResultClass;\n}());\nexports.GameResult = GameResultClass.instance;\n"]}