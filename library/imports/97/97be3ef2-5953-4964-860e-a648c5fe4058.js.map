{"version":3,"sources":["../../../../../../../assets/Script/src/game/game/assets/Script/src/game/game/GameResult.js"],"names":["Object","defineProperty","exports","value","Tools_1","require","GameManager_1","RecordGrid_1","GameDataManager_1","GameEngine_1","GameSceneHepler_1","StorageInfo_1","GameResultClass","randomAry","gameTable","chooseView","gameScene","isStartResult","get","_instance","enumerable","configurable","prototype","setView","setGameScene","scene","getIsStartResult","startResult","idiomAry","chooseMap","RecordGrid","getChooseGridMap","isSussess","i","length","idiom","isEqual","j","substring","getGridString","playChooseFadeOut","clearRecordData","cb1","cc","callFunc","onSuccessFul","node","runAction","sequence","delayTime","GameDataManager","gameData","gridEffectTime","onFailed","clearChooseGrid","playChooseFadeIn","addscore","setScore","score","toString","resetTempData","redPackTimes","StorageInfo","getRedPackTimes","setRedPackTimes","GameManager","onGameOver","GameEngine","changeScene","GameSceneHepler","SETTLE","log","Tools","getGridNumber","tableWidth","tableHeight","getMapLength","getGameTableGridMap","gametime","totalGameTime","onGameLevelup","rewardTime","addScheTimes","playJudgeErrorEffect","restoreIdiom","clearData","GameResult","instance"],"mappings":"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","file":"GameResult.js","sourceRoot":"../../../../../../../assets/Script/src/game/game","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Tools_1 = require(\"../../utils/Tools\");\nvar GameManager_1 = require(\"./GameManager\");\nvar RecordGrid_1 = require(\"../common/model/RecordGrid\");\nvar GameDataManager_1 = require(\"../common/data/GameDataManager\");\nvar GameEngine_1 = require(\"../common/GameEngine\");\nvar GameSceneHepler_1 = require(\"../common/helper/GameSceneHepler\");\nvar StorageInfo_1 = require(\"../common/data/StorageInfo\");\nvar GameResultClass = (function () {\n    function GameResultClass() {\n        this.randomAry = null;\n        this.gameTable = null;\n        this.chooseView = null;\n        this.gameScene = null;\n        this.isStartResult = false;\n    }\n    Object.defineProperty(GameResultClass, \"instance\", {\n        get: function () {\n            if (this._instance == null) {\n                this._instance = new GameResultClass();\n            }\n            return this._instance;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    GameResultClass.prototype.setView = function (gameTable, chooseView) {\n        this.gameTable = gameTable;\n        this.chooseView = chooseView;\n    };\n    GameResultClass.prototype.setGameScene = function (scene) {\n        this.gameScene = scene;\n    };\n    GameResultClass.prototype.getIsStartResult = function () {\n        return this.isStartResult;\n    };\n    GameResultClass.prototype.startResult = function (idiomAry) {\n        this.isStartResult = true;\n        var chooseMap = RecordGrid_1.RecordGrid.getChooseGridMap();\n        var isSussess = false;\n        for (var i = 0; i < idiomAry.length; i++) {\n            var idiom = idiomAry[i];\n            var isEqual = true;\n            for (var j = 0; j < 4; j++) {\n                if (idiom.substring(j, j + 1) != chooseMap.get(j).getGridString()) {\n                    isEqual = false;\n                    break;\n                }\n            }\n            if (isEqual) {\n                isSussess = true;\n                break;\n            }\n        }\n        if (isSussess) {\n            this.chooseView.playChooseFadeOut();\n            RecordGrid_1.RecordGrid.clearRecordData();\n            var cb1 = cc.callFunc(this.onSuccessFul, this);\n            this.gameTable.node.runAction(cc.sequence(cc.delayTime(GameDataManager_1.GameDataManager.gameData.gridEffectTime), cb1));\n        }\n        else {\n            this.onFailed();\n        }\n    };\n    GameResultClass.prototype.onSuccessFul = function () {\n        this.chooseView.clearChooseGrid();\n        this.chooseView.playChooseFadeIn();\n        GameDataManager_1.GameDataManager.gameData.addscore(4);\n        this.gameScene.setScore(GameDataManager_1.GameDataManager.gameData.score.toString());\n        this.isStartResult = false;\n        this.chooseView.resetTempData();\n        var redPackTimes = StorageInfo_1.StorageInfo.getRedPackTimes();\n        if (redPackTimes < 5) {\n            StorageInfo_1.StorageInfo.setRedPackTimes(1);\n            GameManager_1.GameManager.onGameOver();\n            GameEngine_1.GameEngine.changeScene(GameSceneHepler_1.GameSceneHepler.SETTLE);\n        }\n        cc.log(Tools_1.Tools.getGridNumber(this.gameTable.tableWidth, this.gameTable.tableHeight));\n        if (Tools_1.Tools.getMapLength(RecordGrid_1.RecordGrid.getGameTableGridMap()) == 4 * Tools_1.Tools.getGridNumber(this.gameTable.tableWidth, this.gameTable.tableHeight)) {\n            GameDataManager_1.GameDataManager.gameData.gametime = GameDataManager_1.GameDataManager.gameData.totalGameTime;\n            GameManager_1.GameManager.onGameLevelup();\n        }\n        else {\n            var rewardTime = 2;\n            GameDataManager_1.GameDataManager.gameData.gametime = GameDataManager_1.GameDataManager.gameData.gametime + rewardTime;\n            this.gameScene.addScheTimes(rewardTime);\n        }\n    };\n    GameResultClass.prototype.onFailed = function () {\n        this.gameScene.playJudgeErrorEffect();\n        this.chooseView.restoreIdiom();\n        this.clearData();\n        this.isStartResult = false;\n    };\n    GameResultClass.prototype.clearData = function () {\n        RecordGrid_1.RecordGrid.clearRecordData();\n        this.chooseView.clearChooseGrid();\n    };\n    return GameResultClass;\n}());\nexports.GameResult = GameResultClass.instance;\n"]}