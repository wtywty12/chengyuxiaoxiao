{"version":3,"sources":["../../../../../../../assets/Script/src/game/common/assets/Script/src/game/common/ConfigManager.js"],"names":["Object","defineProperty","exports","value","StringUtils_1","require","Base_1","ConfigManagerClass","_checkPointDataMap","Map","_baseDataMap","prototype","get","_base","set","enumerable","configurable","_instance","load","_this","Promise","fulfill","reject","cc","loader","loadResDir","error","datas","urls","i","length","name_1","StringUtils","getName","data","loadOutJson","json","loadCheckPointData","spd","loadBaseData","base","_i","datas_1","hero","id","log","datas_2","key","Base","values","ConfigManager","instance"],"mappings":"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","file":"ConfigManager.js","sourceRoot":"../../../../../../../assets/Script/src/game/common","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar StringUtils_1 = require(\"../../utils/StringUtils\");\nvar Base_1 = require(\"./data/Base\");\nvar ConfigManagerClass = (function () {\n    function ConfigManagerClass() {\n        this._checkPointDataMap = new Map();\n        this._baseDataMap = new Map();\n    }\n    Object.defineProperty(ConfigManagerClass.prototype, \"base\", {\n        get: function () {\n            return this._base;\n        },\n        set: function (value) {\n            this._base = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ConfigManagerClass.prototype, \"baseDataMap\", {\n        get: function () {\n            return this._baseDataMap;\n        },\n        set: function (value) {\n            this._baseDataMap = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ConfigManagerClass.prototype, \"checkPointDataMap\", {\n        get: function () {\n            return this._checkPointDataMap;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ConfigManagerClass, \"instance\", {\n        get: function () {\n            if (this._instance == null) {\n                this._instance = new ConfigManagerClass();\n            }\n            return this._instance;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    ConfigManagerClass.prototype.load = function () {\n        var _this = this;\n        return new Promise(function (fulfill, reject) {\n            cc.loader.loadResDir(\"jsons\", function (error, datas, urls) {\n                if (error) {\n                    cc.error(error);\n                    return;\n                }\n                for (var i = 0; i < datas.length; i++) {\n                    var name_1 = StringUtils_1.StringUtils.getName(urls[i]);\n                    var data = datas[i];\n                    if (name_1 == \"out\") {\n                        _this.loadOutJson(data.json);\n                    }\n                }\n                return fulfill();\n            });\n        });\n    };\n    ConfigManagerClass.prototype.loadOutJson = function (data) {\n        this.loadCheckPointData(data.spd);\n        this.loadBaseData(data.base);\n    };\n    ConfigManagerClass.prototype.loadCheckPointData = function (datas) {\n        if (datas == null) {\n            return;\n        }\n        for (var _i = 0, datas_1 = datas; _i < datas_1.length; _i++) {\n            var hero = datas_1[_i];\n            this._checkPointDataMap.set(hero.id, hero);\n        }\n        cc.log(\"关卡数据\", this._checkPointDataMap);\n    };\n    ConfigManagerClass.prototype.loadBaseData = function (datas) {\n        if (datas == null) {\n            return;\n        }\n        for (var _i = 0, datas_2 = datas; _i < datas_2.length; _i++) {\n            var data = datas_2[_i];\n            this._baseDataMap.set(data.key, data.value);\n        }\n        this._base = new Base_1.Base(this._baseDataMap);\n        cc.log(\" base : \", this._base);\n        cc.log(\" bases : \", this._baseDataMap.values());\n    };\n    return ConfigManagerClass;\n}());\nexports.ConfigManager = ConfigManagerClass.instance;\n"]}