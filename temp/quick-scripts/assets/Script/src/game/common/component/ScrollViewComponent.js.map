{"version":3,"sources":["ScrollViewComponent.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","__decorate","decorators","target","key","desc","c","arguments","length","r","getOwnPropertyDescriptor","Reflect","decorate","i","defineProperty","exports","value","GameScrollView_1","require","_a","cc","_decorator","ccclass","property","ScrollViewComponent","_super","_this","apply","cellItemPrefab","scrollView","_horizontal","_vertical","spacing","cellItemList","cellDataList","lastContentPosition","v2","isUpdateFrame","cellItemTempSize","onLoad","call","content","on","updateContentView","bind","createCellList","vertical","createVerticalCellList","horizontal","createHorizontalCellList","updateCell","index","logicComponent","getComponent","name","updateView","count","node","instantiate","log","getContentSize","Math","ceil","height","setContentSize","size","width","addChild","push","y","x","getPositionInView","item","worldPos","parent","convertToWorldSpaceAR","position","viewPos","convertToNodeSpaceAR","scheduleOnce","updateVerticalContentView","updateHorizontalContentView","isDown","offsetY","offset","newY","idx","isLeft","offsetX","newX","initCellDataList","clearItems","updateCellList","sort","newData","forEach","removeFromParent","Prefab","ScrollView","tooltip","Boolean","Float","GameScrollView"],"mappings":";;;;AAAA;;;;AACA,IAAIA,YAAa,aAAQ,UAAKA,SAAd,IAA6B,YAAY;AACrD,QAAIC,iBAAgB,uBAAUC,CAAV,EAAaC,CAAb,EAAgB;AAChCF,yBAAgBG,OAAOC,cAAP,IACX,EAAEC,WAAW,EAAb,cAA6BC,KAA7B,IAAsC,UAAUL,CAAV,EAAaC,CAAb,EAAgB;AAAED,cAAEI,SAAF,GAAcH,CAAd;AAAkB,SAD/D,IAEZ,UAAUD,CAAV,EAAaC,CAAb,EAAgB;AAAE,iBAAK,IAAIK,CAAT,IAAcL,CAAd;AAAiB,oBAAIA,EAAEM,cAAF,CAAiBD,CAAjB,CAAJ,EAAyBN,EAAEM,CAAF,IAAOL,EAAEK,CAAF,CAAP;AAA1C;AAAwD,SAF9E;AAGA,eAAOP,eAAcC,CAAd,EAAiBC,CAAjB,CAAP;AACH,KALD;AAMA,WAAO,UAAUD,CAAV,EAAaC,CAAb,EAAgB;AACnBF,uBAAcC,CAAd,EAAiBC,CAAjB;AACA,iBAASO,EAAT,GAAc;AAAE,iBAAKC,WAAL,GAAmBT,CAAnB;AAAuB;AACvCA,UAAEU,SAAF,GAAcT,MAAM,IAAN,GAAaC,OAAOS,MAAP,CAAcV,CAAd,CAAb,IAAiCO,GAAGE,SAAH,GAAeT,EAAES,SAAjB,EAA4B,IAAIF,EAAJ,EAA7D,CAAd;AACH,KAJD;AAKH,CAZ2C,EAA5C;AAaA,IAAII,aAAc,aAAQ,UAAKA,UAAd,IAA6B,UAAUC,UAAV,EAAsBC,MAAtB,EAA8BC,GAA9B,EAAmCC,IAAnC,EAAyC;AACnF,QAAIC,IAAIC,UAAUC,MAAlB;AAAA,QAA0BC,IAAIH,IAAI,CAAJ,GAAQH,MAAR,GAAiBE,SAAS,IAAT,GAAgBA,OAAOd,OAAOmB,wBAAP,CAAgCP,MAAhC,EAAwCC,GAAxC,CAAvB,GAAsEC,IAArH;AAAA,QAA2HhB,CAA3H;AACA,QAAI,QAAOsB,OAAP,yCAAOA,OAAP,OAAmB,QAAnB,IAA+B,OAAOA,QAAQC,QAAf,KAA4B,UAA/D,EAA2EH,IAAIE,QAAQC,QAAR,CAAiBV,UAAjB,EAA6BC,MAA7B,EAAqCC,GAArC,EAA0CC,IAA1C,CAAJ,CAA3E,KACK,KAAK,IAAIQ,IAAIX,WAAWM,MAAX,GAAoB,CAAjC,EAAoCK,KAAK,CAAzC,EAA4CA,GAA5C;AAAiD,YAAIxB,IAAIa,WAAWW,CAAX,CAAR,EAAuBJ,IAAI,CAACH,IAAI,CAAJ,GAAQjB,EAAEoB,CAAF,CAAR,GAAeH,IAAI,CAAJ,GAAQjB,EAAEc,MAAF,EAAUC,GAAV,EAAeK,CAAf,CAAR,GAA4BpB,EAAEc,MAAF,EAAUC,GAAV,CAA5C,KAA+DK,CAAnE;AAAxE,KACL,OAAOH,IAAI,CAAJ,IAASG,CAAT,IAAclB,OAAOuB,cAAP,CAAsBX,MAAtB,EAA8BC,GAA9B,EAAmCK,CAAnC,CAAd,EAAqDA,CAA5D;AACH,CALD;AAMAlB,OAAOuB,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C,EAAEC,OAAO,IAAT,EAA7C;AACA,IAAIC,mBAAmBC,QAAQ,wCAAR,CAAvB;AACA,IAAIC,KAAKC,GAAGC,UAAZ;AAAA,IAAwBC,UAAUH,GAAGG,OAArC;AAAA,IAA8CC,WAAWJ,GAAGI,QAA5D;AACA,IAAIC,sBAAuB,UAAUC,MAAV,EAAkB;AACzCtC,cAAUqC,mBAAV,EAA+BC,MAA/B;AACA,aAASD,mBAAT,GAA+B;AAC3B,YAAIE,QAAQD,WAAW,IAAX,IAAmBA,OAAOE,KAAP,CAAa,IAAb,EAAmBpB,SAAnB,CAAnB,IAAoD,IAAhE;AACAmB,cAAME,cAAN,GAAuB,IAAvB;AACAF,cAAMG,UAAN,GAAmB,IAAnB;AACAH,cAAMI,WAAN,GAAoB,KAApB;AACAJ,cAAMK,SAAN,GAAkB,KAAlB;AACAL,cAAMM,OAAN,GAAgB,EAAhB;AACAN,cAAMO,YAAN,GAAqB,IAAIvC,KAAJ,EAArB;AACAgC,cAAMQ,YAAN,GAAqB,IAAIxC,KAAJ,EAArB;AACAgC,cAAMS,mBAAN,GAA4Bf,GAAGgB,EAAH,CAAM,CAAN,EAAS,CAAT,CAA5B;AACAV,cAAMW,aAAN,GAAsB,IAAtB;AACAX,cAAMY,gBAAN,GAAyB,IAAzB;AACA,eAAOZ,KAAP;AACH;AACDF,wBAAoBzB,SAApB,CAA8BwC,MAA9B,GAAuC,YAAY;AAC/Cd,eAAO1B,SAAP,CAAiBwC,MAAjB,CAAwBC,IAAxB,CAA6B,IAA7B;AACA,aAAKX,UAAL,CAAgBY,OAAhB,CAAwBC,EAAxB,CAA2B,kBAA3B,EAA+C,KAAKC,iBAAL,CAAuBC,IAAvB,CAA4B,IAA5B,CAA/C;AACH,KAHD;AAIApB,wBAAoBzB,SAApB,CAA8B8C,cAA9B,GAA+C,YAAY;AACvD,YAAI,KAAKC,QAAT,EAAmB;AACf,iBAAKC,sBAAL;AACH,SAFD,MAGK,IAAI,KAAKC,UAAT,EAAqB;AACtB,iBAAKC,wBAAL;AACH;AACJ,KAPD;AAQAzB,wBAAoBzB,SAApB,CAA8BmD,UAA9B,GAA2C,UAAUC,KAAV,EAAiB;AACxD,YAAIC,iBAAiB,KAAKnB,YAAL,CAAkBkB,KAAlB,EAAyBE,YAAzB,CAAsC,KAAKzB,cAAL,CAAoB0B,IAA1D,CAArB;AACA,YAAIF,kBAAkBA,eAAeG,UAArC,EAAiD;AAC7CH,2BAAeG,UAAf,CAA0BJ,KAA1B,EAAiC,KAAKjB,YAAL,CAAkBiB,KAAlB,CAAjC;AACH;AACJ,KALD;AAMA3B,wBAAoBzB,SAApB,CAA8BgD,sBAA9B,GAAuD,YAAY;AAC/D,YAAIS,QAAQ,EAAZ;AACA,aAAK,IAAI3C,IAAI,CAAb,EAAgBA,IAAI,KAAKqB,YAAL,CAAkB1B,MAAtC,EAA8CK,GAA9C,EAAmD;AAC/C,gBAAIA,IAAI2C,QAAQ,CAAhB,EAAmB;AACf;AACH;AACD,gBAAIC,OAAOrC,GAAGsC,WAAH,CAAe,KAAK9B,cAApB,CAAX;AACAR,eAAGuC,GAAH,CAAO,SAAP,EAAkBF,IAAlB;AACA,gBAAI5C,KAAK,CAAT,EAAY;AACR,qBAAKyB,gBAAL,GAAwBmB,KAAKG,cAAL,EAAxB;AACAJ,wBAAQK,KAAKC,IAAL,CAAU,KAAKL,IAAL,CAAUM,MAAV,GAAmBN,KAAKM,MAAlC,IAA4C,CAApD;AACA,oBAAIA,SAAS,KAAK7B,YAAL,CAAkB1B,MAAlB,IAA4B,KAAK8B,gBAAL,CAAsByB,MAAtB,GAA+B,KAAK/B,OAAhE,CAAb;AACA,qBAAKH,UAAL,CAAgBY,OAAhB,CAAwBuB,cAAxB,CAAuC5C,GAAG6C,IAAH,CAAQ,KAAKpC,UAAL,CAAgBY,OAAhB,CAAwByB,KAAhC,EAAuCH,MAAvC,CAAvC;AACH;AACDN,iBAAK,QAAL,IAAiB5C,CAAjB;AACA,iBAAKgB,UAAL,CAAgBY,OAAhB,CAAwB0B,QAAxB,CAAiCV,IAAjC;AACA,iBAAKxB,YAAL,CAAkBmC,IAAlB,CAAuBX,IAAvB;AACA,gBAAIL,iBAAiB,KAAKnB,YAAL,CAAkBpB,CAAlB,EAAqBwC,YAArB,CAAkC,KAAKzB,cAAL,CAAoB0B,IAAtD,CAArB;AACA,gBAAIF,kBAAkBA,eAAeG,UAArC,EAAiD;AAC7CH,+BAAeG,UAAf,CAA0B1C,CAA1B,EAA6B,KAAKqB,YAAL,CAAkBrB,CAAlB,CAA7B;AACH;AACD4C,iBAAKY,CAAL,GAAS,CAACxD,CAAD,IAAM,KAAKyB,gBAAL,CAAsByB,MAAtB,GAA+B,KAAK/B,OAA1C,CAAT;AACH;AACJ,KAvBD;AAwBAR,wBAAoBzB,SAApB,CAA8BkD,wBAA9B,GAAyD,YAAY;AACjE,YAAIO,QAAQ,EAAZ;AACA,aAAK,IAAI3C,IAAI,CAAb,EAAgBA,IAAI,KAAKqB,YAAL,CAAkB1B,MAAtC,EAA8CK,GAA9C,EAAmD;AAC/C,gBAAIA,IAAI2C,QAAQ,CAAhB,EAAmB;AACf;AACH;AACD,gBAAIC,OAAOrC,GAAGsC,WAAH,CAAe,KAAK9B,cAApB,CAAX;AACAR,eAAGuC,GAAH,CAAO,SAAP,EAAkBF,IAAlB;AACA,gBAAI5C,KAAK,CAAT,EAAY;AACR,qBAAKyB,gBAAL,GAAwBmB,KAAKG,cAAL,EAAxB;AACAJ,wBAAQK,KAAKC,IAAL,CAAU,KAAKL,IAAL,CAAUS,KAAV,GAAkBT,KAAKS,KAAjC,IAA0C,CAAlD;AACA,oBAAIA,QAAQ,KAAKhC,YAAL,CAAkB1B,MAAlB,IAA4B,KAAK8B,gBAAL,CAAsB4B,KAAtB,GAA8B,KAAKlC,OAA/D,CAAZ;AACA,qBAAKH,UAAL,CAAgBY,OAAhB,CAAwBuB,cAAxB,CAAuC5C,GAAG6C,IAAH,CAAQC,KAAR,EAAe,KAAKrC,UAAL,CAAgBY,OAAhB,CAAwBsB,MAAvC,CAAvC;AACH;AACDN,iBAAK,QAAL,IAAiB5C,CAAjB;AACA,iBAAKgB,UAAL,CAAgBY,OAAhB,CAAwB0B,QAAxB,CAAiCV,IAAjC;AACA,iBAAKxB,YAAL,CAAkBmC,IAAlB,CAAuBX,IAAvB;AACA,gBAAIL,iBAAiB,KAAKnB,YAAL,CAAkBpB,CAAlB,EAAqBwC,YAArB,CAAkC,KAAKzB,cAAL,CAAoB0B,IAAtD,CAArB;AACA,gBAAIF,kBAAkBA,eAAeG,UAArC,EAAiD;AAC7CH,+BAAeG,UAAf,CAA0B1C,CAA1B,EAA6B,KAAKqB,YAAL,CAAkBrB,CAAlB,CAA7B;AACH;AACD4C,iBAAKa,CAAL,GAAS,CAAC,KAAKhC,gBAAL,CAAsB4B,KAAtB,GAA8B,KAAKlC,OAApC,IAA+CnB,CAAxD;AACH;AACJ,KAvBD;AAwBAW,wBAAoBzB,SAApB,CAA8BwE,iBAA9B,GAAkD,UAAUC,IAAV,EAAgB;AAC9D,YAAIC,WAAWD,KAAKE,MAAL,CAAYC,qBAAZ,CAAkCH,KAAKI,QAAvC,CAAf;AACA,YAAIC,UAAU,KAAKpB,IAAL,CAAUqB,oBAAV,CAA+BL,QAA/B,CAAd;AACA,eAAOI,OAAP;AACH,KAJD;AAKArD,wBAAoBzB,SAApB,CAA8B4C,iBAA9B,GAAkD,YAAY;AAC1DvB,WAAGuC,GAAH,CAAO,uBAAP;AACA,YAAI,KAAKzB,YAAL,IAAqB,IAArB,IAA6B,KAAKA,YAAL,CAAkB1B,MAAlB,IAA4B,CAA7D,EAAgE;AAC5DY,eAAGuC,GAAH,CAAO,qDAAP,EAA8D,KAAKzB,YAAnE;AACA;AACH;AACD,YAAI,KAAKY,QAAT,EAAmB;AACf,gBAAI,KAAKT,aAAT,EAAwB;AACpB,qBAAKA,aAAL,GAAqB,KAArB;AACA,qBAAK0C,YAAL,CAAkB,KAAKC,yBAAL,CAA+BpC,IAA/B,CAAoC,IAApC,CAAlB,EAA6D,CAA7D;AACH;AACJ,SALD,MAMK;AACD,gBAAI,KAAKP,aAAT,EAAwB;AACpB,qBAAKA,aAAL,GAAqB,KAArB;AACA,qBAAK0C,YAAL,CAAkB,KAAKE,2BAAL,CAAiCrC,IAAjC,CAAsC,IAAtC,CAAlB,EAA+D,CAA/D;AACH;AACJ;AACJ,KAlBD;AAmBApB,wBAAoBzB,SAApB,CAA8BiF,yBAA9B,GAA0D,YAAY;AAClE,YAAIE,SAAS,KAAKrD,UAAL,CAAgBY,OAAhB,CAAwB4B,CAAxB,GAA4B,KAAKlC,mBAAL,CAAyBkC,CAAlE;AACA,YAAIc,UAAU,CAAC,KAAK7C,gBAAL,CAAsByB,MAAtB,GAA+B,KAAK/B,OAArC,IAAgD,KAAKC,YAAL,CAAkBzB,MAAhF;AACA,YAAI4E,SAASD,UAAU,CAAvB;AACA,YAAIE,OAAO,CAAX;AACA,aAAK,IAAIxE,IAAI,CAAb,EAAgBA,IAAI,KAAKoB,YAAL,CAAkBzB,MAAtC,EAA8CK,GAA9C,EAAmD;AAC/C,gBAAIgE,UAAU,KAAKN,iBAAL,CAAuB,KAAKtC,YAAL,CAAkBpB,CAAlB,CAAvB,CAAd;AACA,gBAAIqE,MAAJ,EAAY;AACRG,uBAAO,KAAKpD,YAAL,CAAkBpB,CAAlB,EAAqBwD,CAArB,GAAyBc,OAAhC;AACA,oBAAIN,QAAQR,CAAR,GAAY,EAAEe,SAAS,CAAX,CAAZ,IAA6BC,QAAQ,CAAzC,EAA4C;AACxC,yBAAKpD,YAAL,CAAkBpB,CAAlB,EAAqBwD,CAArB,GAAyBgB,IAAzB;AACA,wBAAIC,MAAM,KAAKrD,YAAL,CAAkBpB,CAAlB,EAAqB,QAArB,IAAiC,KAAKoB,YAAL,CAAkBzB,MAA7D;AACA,wBAAI4C,iBAAiB,KAAKnB,YAAL,CAAkBpB,CAAlB,EAAqBwC,YAArB,CAAkC,KAAKzB,cAAL,CAAoB0B,IAAtD,CAArB;AACA,wBAAIF,kBAAkBA,eAAeG,UAArC,EAAiD;AAC7CH,uCAAeG,UAAf,CAA0B+B,GAA1B,EAA+B,KAAKpD,YAAL,CAAkBoD,GAAlB,CAA/B;AACH;AACD,yBAAKrD,YAAL,CAAkBpB,CAAlB,EAAqB,QAArB,IAAiCyE,GAAjC;AACH;AACJ,aAXD,MAYK;AACDD,uBAAO,KAAKpD,YAAL,CAAkBpB,CAAlB,EAAqBwD,CAArB,GAAyBc,OAAhC;AACA,oBAAIN,QAAQR,CAAR,GAAYe,MAAZ,IAAsBC,OAAO,CAAC,KAAKxD,UAAL,CAAgBY,OAAhB,CAAwBsB,MAA1D,EAAkE;AAC9D,yBAAK9B,YAAL,CAAkBpB,CAAlB,EAAqBwD,CAArB,GAAyBgB,IAAzB;AACA,wBAAIC,MAAM,KAAKrD,YAAL,CAAkBpB,CAAlB,EAAqB,QAArB,IAAiC,KAAKoB,YAAL,CAAkBzB,MAA7D;AACA,wBAAI4C,iBAAiB,KAAKnB,YAAL,CAAkBpB,CAAlB,EAAqBwC,YAArB,CAAkC,KAAKzB,cAAL,CAAoB0B,IAAtD,CAArB;AACA,wBAAIF,kBAAkBA,eAAeG,UAArC,EAAiD;AAC7CH,uCAAeG,UAAf,CAA0B+B,GAA1B,EAA+B,KAAKpD,YAAL,CAAkBoD,GAAlB,CAA/B;AACH;AACD,yBAAKrD,YAAL,CAAkBpB,CAAlB,EAAqB,QAArB,IAAiCyE,GAAjC;AACH;AACJ;AACJ;AACD,aAAKnD,mBAAL,GAA2B,KAAKN,UAAL,CAAgBY,OAAhB,CAAwBmC,QAAnD;AACA,aAAKvC,aAAL,GAAqB,IAArB;AACH,KAlCD;AAmCAb,wBAAoBzB,SAApB,CAA8BkF,2BAA9B,GAA4D,YAAY;AACpE,YAAIM,SAAS,KAAK1D,UAAL,CAAgBY,OAAhB,CAAwB6B,CAAxB,GAA4B,KAAKnC,mBAAL,CAAyBmC,CAAlE;AACA,YAAIkB,UAAU,CAAC,KAAKlD,gBAAL,CAAsB4B,KAAtB,GAA8B,KAAKlC,OAApC,IAA+C,KAAKC,YAAL,CAAkBzB,MAA/E;AACA,YAAI4E,SAASI,UAAU,CAAvB;AACA,YAAIC,OAAO,CAAX;AACA,aAAK,IAAI5E,IAAI,CAAb,EAAgBA,IAAI,KAAKoB,YAAL,CAAkBzB,MAAtC,EAA8CK,GAA9C,EAAmD;AAC/C,gBAAIgE,UAAU,KAAKN,iBAAL,CAAuB,KAAKtC,YAAL,CAAkBpB,CAAlB,CAAvB,CAAd;AACA,gBAAI0E,MAAJ,EAAY;AACRE,uBAAO,KAAKxD,YAAL,CAAkBpB,CAAlB,EAAqByD,CAArB,GAAyBkB,OAAhC;AACA,oBAAIX,QAAQP,CAAR,GAAY,CAACc,MAAb,IAAuBK,OAAO,KAAK5D,UAAL,CAAgBY,OAAhB,CAAwByB,KAA1D,EAAiE;AAC7D,yBAAKjC,YAAL,CAAkBpB,CAAlB,EAAqByD,CAArB,GAAyBmB,IAAzB;AACA,wBAAIH,MAAM,KAAKrD,YAAL,CAAkBpB,CAAlB,EAAqB,QAArB,IAAiC,KAAKoB,YAAL,CAAkBzB,MAA7D;AACA,wBAAI4C,iBAAiB,KAAKnB,YAAL,CAAkBpB,CAAlB,EAAqBwC,YAArB,CAAkC,KAAKzB,cAAL,CAAoB0B,IAAtD,CAArB;AACA,wBAAIF,kBAAkBA,eAAeG,UAArC,EAAiD;AAC7CH,uCAAeG,UAAf,CAA0B+B,GAA1B,EAA+B,KAAKpD,YAAL,CAAkBoD,GAAlB,CAA/B;AACH;AACD,yBAAKrD,YAAL,CAAkBpB,CAAlB,EAAqB,QAArB,IAAiCyE,GAAjC;AACH;AACJ,aAXD,MAYK;AACDG,uBAAO,KAAKxD,YAAL,CAAkBpB,CAAlB,EAAqByD,CAArB,GAAyBkB,OAAhC;AACA,oBAAIX,QAAQP,CAAR,GAAYc,SAAS,CAArB,IAA0BK,QAAQ,CAAtC,EAAyC;AACrC,yBAAKxD,YAAL,CAAkBpB,CAAlB,EAAqByD,CAArB,GAAyBmB,IAAzB;AACA,wBAAIH,MAAM,KAAKrD,YAAL,CAAkBpB,CAAlB,EAAqB,QAArB,IAAiC,KAAKoB,YAAL,CAAkBzB,MAA7D;AACA,wBAAI4C,iBAAiB,KAAKnB,YAAL,CAAkBpB,CAAlB,EAAqBwC,YAArB,CAAkC,KAAKzB,cAAL,CAAoB0B,IAAtD,CAArB;AACA,wBAAIF,kBAAkBA,eAAeG,UAArC,EAAiD;AAC7CH,uCAAeG,UAAf,CAA0B+B,GAA1B,EAA+B,KAAKpD,YAAL,CAAkBoD,GAAlB,CAA/B;AACH;AACD,yBAAKrD,YAAL,CAAkBpB,CAAlB,EAAqB,QAArB,IAAiCyE,GAAjC;AACH;AACJ;AACJ;AACD,aAAKnD,mBAAL,GAA2B,KAAKN,UAAL,CAAgBY,OAAhB,CAAwBmC,QAAnD;AACA,aAAKvC,aAAL,GAAqB,IAArB;AACH,KAlCD;AAmCAb,wBAAoBzB,SAApB,CAA8B2F,gBAA9B,GAAiD,UAAUxD,YAAV,EAAwB;AACrE,aAAKyD,UAAL;AACA,aAAKzD,YAAL,GAAoBA,YAApB;AACA,aAAKW,cAAL;AACH,KAJD;AAKArB,wBAAoBzB,SAApB,CAA8B6F,cAA9B,GAA+C,UAAU1D,YAAV,EAAwB;AACnE,YAAIA,gBAAgB,IAAhB,IAAwBA,aAAa1B,MAAb,IAAuB,CAAnD,EAAsD;AAClDY,eAAGuC,GAAH,CAAO,qDAAP,EAA8DzB,YAA9D;AACA;AACH;AACD,aAAK2D,IAAL,CAAU3D,YAAV;AACA,YAAI,KAAKA,YAAL,IAAqB,IAArB,IAA6B,KAAKA,YAAL,CAAkB1B,MAAlB,IAA4B,CAAzD,IAA8D0B,aAAa1B,MAAb,IAC9D,KAAK0B,YAAL,CAAkB1B,MADtB,EAC8B;AAC1B,iBAAKkF,gBAAL,CAAsBxD,YAAtB;AACA;AACH;AACD,aAAK,IAAIrB,IAAI,CAAb,EAAgBA,IAAIqB,aAAa1B,MAAjC,EAAyCK,GAAzC,EAA8C;AAC1C,gBAAIiF,UAAU5D,aAAarB,CAAb,CAAd;AACA,iBAAKqB,YAAL,CAAkBrB,CAAlB,IAAuBiF,OAAvB;AACA,iBAAK5C,UAAL,CAAgBrC,CAAhB;AACH;AACJ,KAhBD;AAiBAW,wBAAoBzB,SAApB,CAA8B4F,UAA9B,GAA2C,YAAY;AACnD,YAAI,KAAK1D,YAAL,IAAqB,IAArB,IAA6B,KAAKA,YAAL,CAAkBzB,MAAlB,IAA4B,CAA7D,EAAgE;AAC5D;AACH;AACD,aAAKyB,YAAL,CAAkB8D,OAAlB,CAA0B,UAAU/E,KAAV,EAAiB;AACvCA,kBAAMgF,gBAAN,CAAuB,IAAvB;AACH,SAFD;AAGA,aAAK/D,YAAL,GAAoB,IAAIvC,KAAJ,EAApB;AACH,KARD;AASAO,eAAW,CACPsB,SAASH,GAAG6E,MAAZ,CADO,CAAX,EAEGzE,oBAAoBzB,SAFvB,EAEkC,gBAFlC,EAEoD,KAAK,CAFzD;AAGAE,eAAW,CACPsB,SAASH,GAAG8E,UAAZ,CADO,CAAX,EAEG1E,oBAAoBzB,SAFvB,EAEkC,YAFlC,EAEgD,KAAK,CAFrD;AAGAE,eAAW,CACPsB,SAAS,EAAE4E,SAAS,SAAX,MAA0B/E,GAAGgF,OAAtC,CADO,CAAX,EAEG5E,oBAAoBzB,SAFvB,EAEkC,aAFlC,EAEiD,KAAK,CAFtD;AAGAE,eAAW,CACPsB,SAAS,EAAE4E,SAAS,SAAX,MAA0B/E,GAAGgF,OAAtC,CADO,CAAX,EAEG5E,oBAAoBzB,SAFvB,EAEkC,WAFlC,EAE+C,KAAK,CAFpD;AAGAE,eAAW,CACPsB,SAASH,GAAGiF,KAAZ,CADO,CAAX,EAEG7E,oBAAoBzB,SAFvB,EAEkC,SAFlC,EAE6C,KAAK,CAFlD;AAGAyB,0BAAsBvB,WAAW,CAC7BqB,OAD6B,CAAX,EAEnBE,mBAFmB,CAAtB;AAGA,WAAOA,mBAAP;AACH,CAlO0B,CAkOzBP,iBAAiBqF,cAlOQ,CAA3B;AAmOAvF,QAAQS,mBAAR,GAA8BA,mBAA9B","file":"ScrollViewComponent.js","sourceRoot":"../../../../../../../../assets/Script/src/game/common/component","sourcesContent":["\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar GameScrollView_1 = require(\"../../../core/component/GameScrollView\");\nvar _a = cc._decorator, ccclass = _a.ccclass, property = _a.property;\nvar ScrollViewComponent = (function (_super) {\n    __extends(ScrollViewComponent, _super);\n    function ScrollViewComponent() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.cellItemPrefab = null;\n        _this.scrollView = null;\n        _this._horizontal = false;\n        _this._vertical = false;\n        _this.spacing = 10;\n        _this.cellItemList = new Array();\n        _this.cellDataList = new Array();\n        _this.lastContentPosition = cc.v2(0, 0);\n        _this.isUpdateFrame = true;\n        _this.cellItemTempSize = null;\n        return _this;\n    }\n    ScrollViewComponent.prototype.onLoad = function () {\n        _super.prototype.onLoad.call(this);\n        this.scrollView.content.on(\"position-changed\", this.updateContentView.bind(this));\n    };\n    ScrollViewComponent.prototype.createCellList = function () {\n        if (this.vertical) {\n            this.createVerticalCellList();\n        }\n        else if (this.horizontal) {\n            this.createHorizontalCellList();\n        }\n    };\n    ScrollViewComponent.prototype.updateCell = function (index) {\n        var logicComponent = this.cellItemList[index].getComponent(this.cellItemPrefab.name);\n        if (logicComponent && logicComponent.updateView) {\n            logicComponent.updateView(index, this.cellDataList[index]);\n        }\n    };\n    ScrollViewComponent.prototype.createVerticalCellList = function () {\n        var count = 10;\n        for (var i = 0; i < this.cellDataList.length; i++) {\n            if (i > count - 1) {\n                return;\n            }\n            var node = cc.instantiate(this.cellItemPrefab);\n            cc.log(\"node  :\", node);\n            if (i == 0) {\n                this.cellItemTempSize = node.getContentSize();\n                count = Math.ceil(this.node.height / node.height) * 2;\n                var height = this.cellDataList.length * (this.cellItemTempSize.height + this.spacing);\n                this.scrollView.content.setContentSize(cc.size(this.scrollView.content.width, height));\n            }\n            node[\"cellID\"] = i;\n            this.scrollView.content.addChild(node);\n            this.cellItemList.push(node);\n            var logicComponent = this.cellItemList[i].getComponent(this.cellItemPrefab.name);\n            if (logicComponent && logicComponent.updateView) {\n                logicComponent.updateView(i, this.cellDataList[i]);\n            }\n            node.y = -i * (this.cellItemTempSize.height + this.spacing);\n        }\n    };\n    ScrollViewComponent.prototype.createHorizontalCellList = function () {\n        var count = 10;\n        for (var i = 0; i < this.cellDataList.length; i++) {\n            if (i > count - 1) {\n                return;\n            }\n            var node = cc.instantiate(this.cellItemPrefab);\n            cc.log(\"node  :\", node);\n            if (i == 0) {\n                this.cellItemTempSize = node.getContentSize();\n                count = Math.ceil(this.node.width / node.width) * 2;\n                var width = this.cellDataList.length * (this.cellItemTempSize.width + this.spacing);\n                this.scrollView.content.setContentSize(cc.size(width, this.scrollView.content.height));\n            }\n            node[\"cellID\"] = i;\n            this.scrollView.content.addChild(node);\n            this.cellItemList.push(node);\n            var logicComponent = this.cellItemList[i].getComponent(this.cellItemPrefab.name);\n            if (logicComponent && logicComponent.updateView) {\n                logicComponent.updateView(i, this.cellDataList[i]);\n            }\n            node.x = (this.cellItemTempSize.width + this.spacing) * i;\n        }\n    };\n    ScrollViewComponent.prototype.getPositionInView = function (item) {\n        var worldPos = item.parent.convertToWorldSpaceAR(item.position);\n        var viewPos = this.node.convertToNodeSpaceAR(worldPos);\n        return viewPos;\n    };\n    ScrollViewComponent.prototype.updateContentView = function () {\n        cc.log(\"updateContentView   :\");\n        if (this.cellDataList == null || this.cellDataList.length == 0) {\n            cc.log(\"updateCellList cellDataList is null, cellDataList: \", this.cellDataList);\n            return;\n        }\n        if (this.vertical) {\n            if (this.isUpdateFrame) {\n                this.isUpdateFrame = false;\n                this.scheduleOnce(this.updateVerticalContentView.bind(this), 0);\n            }\n        }\n        else {\n            if (this.isUpdateFrame) {\n                this.isUpdateFrame = false;\n                this.scheduleOnce(this.updateHorizontalContentView.bind(this), 0);\n            }\n        }\n    };\n    ScrollViewComponent.prototype.updateVerticalContentView = function () {\n        var isDown = this.scrollView.content.y < this.lastContentPosition.y;\n        var offsetY = (this.cellItemTempSize.height + this.spacing) * this.cellItemList.length;\n        var offset = offsetY / 4;\n        var newY = 0;\n        for (var i = 0; i < this.cellItemList.length; i++) {\n            var viewPos = this.getPositionInView(this.cellItemList[i]);\n            if (isDown) {\n                newY = this.cellItemList[i].y + offsetY;\n                if (viewPos.y < -(offset * 3) && newY <= 0) {\n                    this.cellItemList[i].y = newY;\n                    var idx = this.cellItemList[i][\"cellID\"] - this.cellItemList.length;\n                    var logicComponent = this.cellItemList[i].getComponent(this.cellItemPrefab.name);\n                    if (logicComponent && logicComponent.updateView) {\n                        logicComponent.updateView(idx, this.cellDataList[idx]);\n                    }\n                    this.cellItemList[i][\"cellID\"] = idx;\n                }\n            }\n            else {\n                newY = this.cellItemList[i].y - offsetY;\n                if (viewPos.y > offset && newY > -this.scrollView.content.height) {\n                    this.cellItemList[i].y = newY;\n                    var idx = this.cellItemList[i][\"cellID\"] + this.cellItemList.length;\n                    var logicComponent = this.cellItemList[i].getComponent(this.cellItemPrefab.name);\n                    if (logicComponent && logicComponent.updateView) {\n                        logicComponent.updateView(idx, this.cellDataList[idx]);\n                    }\n                    this.cellItemList[i][\"cellID\"] = idx;\n                }\n            }\n        }\n        this.lastContentPosition = this.scrollView.content.position;\n        this.isUpdateFrame = true;\n    };\n    ScrollViewComponent.prototype.updateHorizontalContentView = function () {\n        var isLeft = this.scrollView.content.x < this.lastContentPosition.x;\n        var offsetX = (this.cellItemTempSize.width + this.spacing) * this.cellItemList.length;\n        var offset = offsetX / 4;\n        var newX = 0;\n        for (var i = 0; i < this.cellItemList.length; i++) {\n            var viewPos = this.getPositionInView(this.cellItemList[i]);\n            if (isLeft) {\n                newX = this.cellItemList[i].x + offsetX;\n                if (viewPos.x < -offset && newX < this.scrollView.content.width) {\n                    this.cellItemList[i].x = newX;\n                    var idx = this.cellItemList[i][\"cellID\"] + this.cellItemList.length;\n                    var logicComponent = this.cellItemList[i].getComponent(this.cellItemPrefab.name);\n                    if (logicComponent && logicComponent.updateView) {\n                        logicComponent.updateView(idx, this.cellDataList[idx]);\n                    }\n                    this.cellItemList[i][\"cellID\"] = idx;\n                }\n            }\n            else {\n                newX = this.cellItemList[i].x - offsetX;\n                if (viewPos.x > offset * 3 && newX >= 0) {\n                    this.cellItemList[i].x = newX;\n                    var idx = this.cellItemList[i][\"cellID\"] - this.cellItemList.length;\n                    var logicComponent = this.cellItemList[i].getComponent(this.cellItemPrefab.name);\n                    if (logicComponent && logicComponent.updateView) {\n                        logicComponent.updateView(idx, this.cellDataList[idx]);\n                    }\n                    this.cellItemList[i][\"cellID\"] = idx;\n                }\n            }\n        }\n        this.lastContentPosition = this.scrollView.content.position;\n        this.isUpdateFrame = true;\n    };\n    ScrollViewComponent.prototype.initCellDataList = function (cellDataList) {\n        this.clearItems();\n        this.cellDataList = cellDataList;\n        this.createCellList();\n    };\n    ScrollViewComponent.prototype.updateCellList = function (cellDataList) {\n        if (cellDataList == null || cellDataList.length == 0) {\n            cc.log(\"updateCellList cellDataList is null, cellDataList: \", cellDataList);\n            return;\n        }\n        this.sort(cellDataList);\n        if (this.cellDataList == null || this.cellDataList.length == 0 || cellDataList.length !=\n            this.cellDataList.length) {\n            this.initCellDataList(cellDataList);\n            return;\n        }\n        for (var i = 0; i < cellDataList.length; i++) {\n            var newData = cellDataList[i];\n            this.cellDataList[i] = newData;\n            this.updateCell(i);\n        }\n    };\n    ScrollViewComponent.prototype.clearItems = function () {\n        if (this.cellItemList == null || this.cellItemList.length == 0) {\n            return;\n        }\n        this.cellItemList.forEach(function (value) {\n            value.removeFromParent(true);\n        });\n        this.cellItemList = new Array();\n    };\n    __decorate([\n        property(cc.Prefab)\n    ], ScrollViewComponent.prototype, \"cellItemPrefab\", void 0);\n    __decorate([\n        property(cc.ScrollView)\n    ], ScrollViewComponent.prototype, \"scrollView\", void 0);\n    __decorate([\n        property({ tooltip: \"是否是垂直滚动\" } || cc.Boolean)\n    ], ScrollViewComponent.prototype, \"_horizontal\", void 0);\n    __decorate([\n        property({ tooltip: \"是否是水平滚动\" } || cc.Boolean)\n    ], ScrollViewComponent.prototype, \"_vertical\", void 0);\n    __decorate([\n        property(cc.Float)\n    ], ScrollViewComponent.prototype, \"spacing\", void 0);\n    ScrollViewComponent = __decorate([\n        ccclass\n    ], ScrollViewComponent);\n    return ScrollViewComponent;\n}(GameScrollView_1.GameScrollView));\nexports.ScrollViewComponent = ScrollViewComponent;\n"]}