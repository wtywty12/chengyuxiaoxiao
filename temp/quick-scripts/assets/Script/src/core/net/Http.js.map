{"version":3,"sources":["Http.js"],"names":["Object","defineProperty","exports","value","Http","baseURL","prototype","httpGet","url","success","error","xhr","cc","loader","getXMLHttpRequest","onreadystatechange","readyState","status","response","JSON","parse","responseText","open","sys","isNative","setRequestHeader","ontimeout","event","onerror","timeout","send","httpPost","params","encodeFormData","data","pairs","regexp","name_1","pair","encodeURIComponent","replace","push","join"],"mappings":"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","file":"Http.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\Script\\src\\core\\net","sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Http = (function () {\r\n    function Http(baseURL) {\r\n        this.baseURL = baseURL;\r\n    }\r\n    Http.prototype.httpGet = function (url, success, error) {\r\n        if (error === void 0) { error = null; }\r\n        var xhr = cc.loader.getXMLHttpRequest();\r\n        xhr.onreadystatechange = function () {\r\n            if (xhr.readyState === 4) {\r\n                if (xhr.status >= 200 && xhr.status < 300) {\r\n                    var response = JSON.parse(xhr.responseText);\r\n                    if (success != null) {\r\n                        success(response);\r\n                    }\r\n                }\r\n                else {\r\n                    if (error != null) {\r\n                        error({ \"status\": xhr.status });\r\n                    }\r\n                }\r\n            }\r\n        };\r\n        xhr.open(\"GET\", this.baseURL + url, true);\r\n        if (cc.sys.isNative) {\r\n            xhr.setRequestHeader(\"Accept-Encoding\", \"gzip,deflate\");\r\n        }\r\n        xhr.ontimeout = function (event) {\r\n            if (error != null) {\r\n                error(event);\r\n            }\r\n        };\r\n        xhr.onerror = function (event) {\r\n            if (error != null) {\r\n                error(event);\r\n            }\r\n        };\r\n        xhr.timeout = 3000;\r\n        xhr.send();\r\n    };\r\n    Http.prototype.httpPost = function (url, params, success, error) {\r\n        if (error === void 0) { error = null; }\r\n        var xhr = cc.loader.getXMLHttpRequest();\r\n        xhr.onreadystatechange = function () {\r\n            if (xhr.readyState === 4) {\r\n                if (xhr.status >= 200 && xhr.status < 300) {\r\n                    var response = JSON.parse(xhr.responseText);\r\n                    if (success != null) {\r\n                        success(response);\r\n                    }\r\n                }\r\n                else {\r\n                    if (error != null) {\r\n                        error({ \"status\": xhr.status });\r\n                    }\r\n                }\r\n            }\r\n        };\r\n        xhr.open(\"POST\", this.baseURL + url, true);\r\n        if (cc.sys.isNative) {\r\n            xhr.setRequestHeader(\"Accept-Encoding\", \"gzip,deflate\");\r\n        }\r\n        xhr.setRequestHeader(\"Content-Type\", \"application/x-www-form-urlencoded\");\r\n        xhr.ontimeout = function (event) {\r\n            if (error != null) {\r\n                error(event);\r\n            }\r\n        };\r\n        xhr.onerror = function (event) {\r\n            if (error != null) {\r\n                error(event);\r\n            }\r\n        };\r\n        xhr.timeout = 5000;\r\n        xhr.send(this.encodeFormData(params));\r\n    };\r\n    Http.prototype.encodeFormData = function (data) {\r\n        var pairs = [];\r\n        var regexp = /%20/g;\r\n        for (var name_1 in data) {\r\n            var value = data[name_1];\r\n            var pair = encodeURIComponent(name_1).replace(regexp, \"+\") + \"=\" + encodeURIComponent(value).replace(regexp, \"+\");\r\n            pairs.push(pair);\r\n        }\r\n        return pairs.join(\"&\");\r\n    };\r\n    return Http;\r\n}());\r\nexports.Http = Http;\r\n"]}